
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Flipzy MiniApp</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background: #0d1f1e;
      color: #fff;
    }
    .screen {
      display: none;
      padding: 20px;
      text-align: center;
    }
    .screen.active {
      display: block;
    }
    .balance {
      font-size: 24px;
      margin: 20px 0 10px;
      font-weight: bold;
      color: #ffd700;
    }
    .box {
      background-color: #1c2d2c;
      border-radius: 16px;
      padding: 16px;
      margin: 10px auto;
      max-width: 340px;
      color: #fff;
    }
    .ref-link-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: #2b413f;
      border-radius: 12px;
      padding: 10px;
      overflow-wrap: break-word;
    }
    .copy-btn {
      background-color: #3a5c59;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      margin-left: 10px;
      cursor: pointer;
    }
    .level-box {
      background-color: #1c2d2c;
      border-radius: 16px;
      padding: 12px;
      margin: 8px auto;
      max-width: 340px;
      color: #fff;
    }
    .tabbar {
      position: fixed;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-around;
      background: #132523;
      border-top: 1px solid #ccc;
      padding: 10px 0;
    }
    .tabbar button {
      background: none;
      border: none;
      font-size: 14px;
      color: #999;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .tabbar button.active {
      color: #ffd700;
      font-weight: bold;
    }
    #ton-connect-button {
      margin: 20px auto;
      display: flex;
      justify-content: center;
    }
    .button {
      padding: 12px 20px;
      margin: 10px auto;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
      display: block;
    }
    .help-link {
      display: flex;
      align-items: center;
      background-color: #1c2d2c;
      margin: 10px auto;
      border-radius: 16px;
      padding: 14px;
      max-width: 340px;
      font-size: 16px;
      color: #fff;
      text-decoration: none;
      justify-content: flex-start;
    }
    .help-link img {
      height: 24px;
      margin-right: 10px;
    }
  </style>
</head>
<body>

<div id="main" class="screen active">
  <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Flipzy!</h2>
  <div class="balance">ü™ô –ë–∞–ª–∞–Ω—Å: <span id="balance">0.00 USDT</span></div>
  <div id="ton-connect-button"></div>
  <p id="wallet-address"></p>
  <button class="button" onclick="paySubscription()">üí≥ –û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
</div>

<div id="referrals" class="screen">
  <div class="box">
    <div class="balance">$13,900.00</div>
    <div class="ref-link-container">
      <span id="referral-link">https://t.me/FlipzyBot?start=</span>
      <button class="copy-btn" onclick="copyReferralLink()">COPY</button>
    </div>
  </div>
  <div class="box">
    <p style="margin:0; text-align:left;">Your Referral Link</p>
    <div class="ref-link-container">
      <span style="font-size: 12px;">https://t.me/FlipzyBot?start=</span>
      <img src="https://img.icons8.com/ios-filled/24/ffffff/add-user-group-man-man.png"/>
    </div>
  </div>
  <div class="level-box">
    <p style="margin:0;">Level 1<br><small>Earn $6.00 per referral</small></p>
  </div>
  <div class="level-box">
    <p style="margin:0;">Level 2<br><small>Earn $2.00 per referral</small></p>
  </div>
</div>

<div id="rewards" class="screen">
  <h2>üéÅ –ù–∞–≥—Ä–∞–¥—ã</h2>
  <p>–¢–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –±–æ–Ω—É—Å—ã</p>
</div>

<div id="help" class="screen">
  <h2>‚ùì –ü–æ–º–æ—â—å</h2>
  <a class="help-link" href="#"><img src="https://img.icons8.com/ios-filled/50/ffffff/telegram-app.png"/>Telegram Chat</a>
  <a class="help-link" href="#"><img src="https://img.icons8.com/ios-filled/50/ffffff/telegram-app.png"/>FAQ</a>
  <a class="help-link" href="#"><img src="https://img.icons8.com/ios-filled/50/ffffff/telegram-app.png"/>Community</a>
</div>

<div class="tabbar">
  <button onclick="showScreen('main')" id="tab-main" class="active">üè†<span>–ì–ª–∞–≤–Ω–∞—è</span></button>
  <button onclick="showScreen('referrals')" id="tab-referrals">üë•<span>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</span></button>
  <button onclick="showScreen('rewards')" id="tab-rewards">üéÅ<span>–ù–∞–≥—Ä–∞–¥—ã</span></button>
  <button onclick="showScreen('help')" id="tab-help">‚ùì<span>–ü–æ–º–æ—â—å</span></button>
</div>

<script>
  const tg = window.Telegram.WebApp;
  tg.expand();
  tg.ready();

  function paySubscription() {
    tg.sendData(JSON.stringify({ type: "pay_subscription" }));
    alert("üí≥ –ò–º–∏—Ç–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–∫–∏!");
  }

  function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');

    document.querySelectorAll('.tabbar button').forEach(b => b.classList.remove('active'));
    document.getElementById("tab-" + id).classList.add('active');
  }

  function copyReferralLink() {
    const linkText = document.getElementById("referral-link").innerText;
    navigator.clipboard.writeText(linkText).then(() => {
      alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! üìã");
    });
  }

  const ton = new TON_CONNECT_UI.TonConnectUI({
    manifestUrl: 'tonconnect-manifest.json',
    buttonRootId: 'ton-connect-button'
  });

  ton.onStatusChange(wallet => {
    if (wallet?.account?.address) {
      document.getElementById('wallet-address').innerText = `üìé ${wallet.account.address}`;
      const refUrl = `https://t.me/flipzy_bot?start=${wallet.account.address}`;
      document.getElementById('referral-link').innerText = refUrl;
      Telegram.WebApp.sendData(JSON.stringify({
        type: 'wallet_connected',
        address: wallet.account.address
      }));
    }
  });
</script>

</body>
</html>
